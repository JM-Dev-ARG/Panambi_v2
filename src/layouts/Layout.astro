---
import { ClientRouter } from "astro:transitions";
import "../styles/global.css";

//importacion de imagenes
import icono_metadata from "@/assets/svg/logotipo.svg";
import favicon from "@/assets/svg/logotipo.svg";

//data para schema
import dataSchema from "@/data/seoSchema.json";
import NavbarWeb from "@/components/base-components/navbar/NavbarWeb.astro";
import NavBarMovil from "@/components/base-components/navbar/NavBarMovil.astro";
import Footer from "@/components/base-components/Footer.astro";

interface Props {
  title: string;
  description: string;
  keywords?: string[];
  ogImage?: string; // Opcional: imagen específica por página
}
const { title, description, keywords, ogImage } = Astro.props;

// URL canónica dinámica por página
const canonicalURL = new URL(Astro.url.pathname, Astro.site).toString();

// Imagen OG dinámica o por defecto
const ogImageURL =
  ogImage || new URL(icono_metadata.src, Astro.site).toString();

// Schema genérico para WebPage y Organization
const schema = {
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "ProfessionalService",
      "@id": `${Astro.site}#organization`,
      name: "Panambi",
      description:
        "Estrategia digital, desarrollo web y contenido visual para profesionales y empresas",
      email: "info@panambi.net",
      url: Astro.site?.toString(),
      logo: {
        "@type": "ImageObject",
        url: dataSchema.logo,
      },
      contactPoint: {
        "@type": "ContactPoint",
        telephone: dataSchema.contactPoint.telephone,
        contactType: "Atención al cliente",
        areaServed: dataSchema.contactPoint.areaServed,
        availableLanguage: dataSchema.contactPoint.availableLanguage,
      },
      sameAs: dataSchema.sameAs,
      address: {
        "@type": "PostalAddress",
        streetAddress: dataSchema.address.streetAddress,
        addressLocality: dataSchema.address.addressLocality,
        addressRegion: dataSchema.address.addressRegion,
        postalCode: dataSchema.address.postalCode,
        addressCountry: dataSchema.address.addressCountry,
      },
    },
    {
      "@type": "WebPage",
      "@id": canonicalURL,
      url: canonicalURL,
      name: title,
      description: description,
      isPartOf: {
        "@id": `${Astro.site}#website`,
      },
      about: {
        "@id": `${Astro.site}#organization`,
      },
      inLanguage: "es-AR",
    },
  ],
};
---

<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content={Astro.generator} />

    <!-- Title y Description -->
    <title>{title}</title>
    <meta name="description" content={description} />

    <!-- Canonical URL dinámica -->
    <link rel="canonical" href={canonicalURL} />

    <!-- Keywords -->
    {
      keywords && keywords.length > 0 && (
        <meta name="keywords" content={keywords.join(", ")} />
      )
    }

    <!-- Robots y Author -->
    <meta name="robots" content="index, follow" />
    <meta name="author" content="Panambi" />

    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href={favicon.src} />
    <link rel="apple-touch-icon" href={favicon.src} />

    <!-- Client Router -->
    <ClientRouter />

    <!-- Schema.org markup -->
    <script type="application/ld+json" set:html={JSON.stringify(schema)} />

    <!-- Facebook Open Graph -->
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:type" content="website" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImageURL} />
    <meta property="og:locale" content="es_AR" />
    <meta property="og:site_name" content="Panambi" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={canonicalURL} />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImageURL} />

    <!-- Meta Pixel Code -->
    <!-- End Meta Pixel Code -->

    <!-- Google tag (gtag.js) -->
    <!-- End Google tag (gtag.js) -->

    <!-- Metricool tracker -->
    <!-- End Metricool tracker -->
  </head>
  <body>
    <NavbarWeb />
    <NavBarMovil />
    <slot />
    <Footer />
  </body>
</html>

<style>
  :root {
    interpolate-size: allow-keywords;
    scroll-behavior: smooth;
    transition-behavior: allow-discrete;
  }
  body {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    background-color: #f9f9f9;
    font-family: var(--font-base);
  }
</style>

<script>
  import AOS from "aos";
  import "aos/dist/aos.css";
  document.addEventListener("astro:page-load", () => {
    AOS.init({
      once: true,
      duration: 800,
    });
  });
</script>
